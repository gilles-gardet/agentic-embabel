# Agentic Embabel - Programming Joke Generator

A Spring Boot application demonstrating [Embabel Agent](https://docs.embabel.com/) framework capabilities through an AI-powered programming joke generator.

## What is This Project?

This application showcases **Embabel Agent**, a JVM-based framework for building agentic AI systems. It demonstrates how to create autonomous AI agents that can reason, plan, and execute multi-step workflows without manual orchestration.

The demo application:
1. Generates multiple programming jokes about a given topic using LLMs
2. Automatically evaluates and selects the best joke
3. Provides reasoning for why that joke is the funniest

## Understanding Embabel Agent

**Embabel Agent** is a framework for building intelligent, goal-oriented AI systems that combine the power of Large Language Models with traditional programming logic. Unlike simple LLM wrappers, Embabel enables agents to:

- **Autonomously plan action sequences** using Goal-Oriented Action Planning (GOAP)
- **Adapt to new information** through an OODA loop (Observe-Orient-Decide-Act)
- **Maintain type safety** with strongly-typed domain models
- **Integrate with enterprise systems** via Spring Boot

### Key Concepts

- **@Agent**: Marks a class as an autonomous agent with planning capabilities
- **@Action**: Defines discrete steps the agent can execute; inputs define preconditions, return types define postconditions
- **@AchievesGoal**: Marks terminal actions that satisfy the agent's objective
- **Blackboard Pattern**: Shared memory system where actions read inputs and write outputs, enabling loose coupling
- **Automatic Planning**: The framework analyzes method signatures to automatically determine action sequences using A* search

In this demo, the `JokeAgent` has two actions:
1. `generateJokes()` - Creates a collection of jokes (produces `JokeCollection`)
2. `selectBestJoke()` - Consumes `JokeCollection`, produces `BestJoke` (marked with `@AchievesGoal`)

Embabel automatically infers that `generateJokes` must run before `selectBestJoke` based on their type signatures, without requiring explicit workflow definition.

## Prerequisites

- Java 21.0.9-tem (managed via SDKMAN with `.sdkmanrc`)
- Maven 3.9.9 (managed via SDKMAN with `.sdkmanrc`)
- Kotlin 2.1.0 (managed via SDKMAN with `.sdkmanrc`)
- OpenAI API key (Anthropic support available but not configured)

> **Note**: This project uses SDKMAN for version management. Run `sdk env install` to automatically install the required versions specified in `.sdkmanrc`.

## Configuration

Before running the application, configure your API key:

```bash
export OPENAI_API_KEY="your-openai-api-key"
```

## Installation and Running

```bash
# Install required SDK versions (first time only)
sdk env install

# Build the project
mvn clean install

# Run the application
mvn spring-boot:run
```

The application starts on port 8080 by default.

## API Usage

The application exposes a simple GET endpoint to generate and retrieve the best joke:

```bash
# Generate best joke about "programming" with default count (5 jokes)
curl http://localhost:8080/api/jokes/best

# Generate best joke about "Java" (5 jokes generated by default)
curl http://localhost:8080/api/jokes/best?topic=Java

# Generate best joke about "bugs" with 3 jokes
curl "http://localhost:8080/api/jokes/best?topic=bugs&count=3"
```

**Parameters:**
- `topic` (optional): The programming topic for jokes (default: "programming")
- `count` (optional): Number of jokes to generate before selection (default: 5)

### Response Example

```
Why do developers prefer dark mode? Because light attracts bugs!
```

The endpoint returns the text of the best joke selected by the AI agent as plain text.

## Project Architecture

### Main Components

- **JokeAgent** (`src/main/kotlin/.../agent/JokeAgent.kt`): Embabel agent orchestrating joke generation and selection
  - `generateJokes`: Action that generates N jokes on a topic
  - `selectBestJoke`: Terminal action (@AchievesGoal) that selects the best joke

- **JokeController** (`src/main/kotlin/.../controller/JokeController.kt`): REST API exposing agent functionality

- **Domain Models** (`src/main/kotlin/.../model/`):
  - `Joke`: Represents a joke with text and humor score
  - `JokeCollection`: Collection of generated jokes
  - `BestJoke`: Selected best joke with reasoning
  - `JokeRequest`: Request for generating jokes (topic and count)

### How the Agent Works

The agent operates autonomously through these steps:

1. **Goal Definition**: User requests the best joke via API
2. **Planning**: Embabel analyzes available actions and determines it needs `JokeCollection` to produce `BestJoke`
3. **Execution**:
   - First executes `generateJokes()` which uses LLM to create multiple jokes
   - Then executes `selectBestJoke()` which analyzes all jokes and picks the winner
4. **Adaptation**: If any action produces unexpected results, the agent replans automatically

This demonstrates the core value of Embabel: **declarative AI workflows** where you define capabilities (actions) and goals, and the framework handles orchestration.

## Configuration

Edit `src/main/resources/application.yml` to customize:

```yaml
server:
  port: 8080

logging:
  level:
    com.ggardet.agenticembabel: INFO
    com.embabel: INFO

spring:
  application:
    name: agentic-embabel
```

Note: LLM model configuration is handled through environment variables and Embabel's auto-configuration.

## Technology Stack

- **Spring Boot 3.5.7**: Web framework and dependency injection
- **Kotlin 2.1.0**: Primary programming language
- **Embabel Agent 0.2.0**: Agentic AI framework
  - `embabel-agent-starter`: Core framework
  - `embabel-agent-starter-openai`: OpenAI integration
- **Java 21**: Runtime platform
- **Maven**: Build tool and dependency management

## Learning Resources

- [Embabel Agent Documentation](https://docs.embabel.com/embabel-agent/guide/0.2.0/) - Framework guide and concepts
- [Spring Boot Documentation](https://docs.spring.io/spring-boot/docs/current/reference/html/)
- [Kotlin Documentation](https://kotlinlang.org/docs/home.html)

## Why This Matters

This demo illustrates how Embabel Agent enables developers to build sophisticated AI workflows that:
- Automatically coordinate multiple LLM calls
- Maintain type safety and testability
- Integrate seamlessly with enterprise Java/Kotlin applications
- Adapt to changing requirements without manual workflow updates

The joke generator is intentionally simple to demonstrate these concepts clearly, but the same patterns scale to complex enterprise use cases like document processing, customer service automation, and intelligent data analysis.
